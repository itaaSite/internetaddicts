---
import { getCollection } from "astro:content"
import Container from "./Container.astro"

const [posts, stories, groups] = await Promise.all([
	getCollection("posts"),
	getCollection("story"),
	getCollection("groups"),
])

const uniqueGroups = groups.filter(
	(item, index, self) => self.findIndex(g => g.data.title === item.data.title) === index,
)

const sections = [
	{
		title: "Архив статей",
		items: posts.slice(0, 6).map(item => ({
			title: item.data.title,
			url: `/posts/${item.slug}`,
		})),
	},
	{
		title: "Личные истории",
		items: stories.map(item => ({
			title: item.data.title,
			url: `/stories/${item.slug}`,
		})),
	},
	{
		title: "Группы",
		items: uniqueGroups.map(item => ({
			title: item.data.title,
			url: `/groups/`,
		})),
	},
]
---

<footer class="py-6 bg-white">
	<div class="py-8">
		<Container class="max-w-6xl mx-auto">
			<div
				class="grid grid-cols-1 md:grid-cols-2 justify-items-center lg:grid-cols-3 gap-12"
			>
				{
					sections.map(section => (
						<div class="flex flex-col gap-3 items-center md:items-start">
							<span class="text-lg text-zinc-700 font-bold">{section.title}</span>
							{section.items.map(({ title, url }) => (
								<a
									href={url}
									class="items-center flex gap-1 md:text-left text-center text-zinc-500"
								>
									<span>{title}</span>
								</a>
							))}
						</div>
					))
				}
			</div>
		</Container>
	</div>

	<Container
		class="max-w-6xl sm:flex-row flex-col px-5 mx-auto flex items-center justify-between gap-2 md:gap-6 p-3"
	>
		<span>&copy; {new Date().getFullYear()} <b>internetaddicts.ru</b></span>
		<span class="text-sm text-zinc-500">
			Разработчик:
			<a
				href="https://github.com/proxima812"
				target="_blank"
				rel="noopener noreferrer"
				class="ml-1 inline-flex items-center gap-1.5 font-semibold text-zinc-700 hover:text-zinc-900 underline"
			>
				<svg
					viewBox="0 0 24 24"
					aria-hidden="true"
					class="h-4 w-4"
					fill="currentColor"
				>
					<path
						d="M12 .5a12 12 0 0 0-3.79 23.39c.6.11.82-.26.82-.58v-2.02c-3.34.73-4.04-1.41-4.04-1.41-.55-1.37-1.34-1.74-1.34-1.74-1.1-.74.08-.73.08-.73 1.21.08 1.85 1.22 1.85 1.22 1.08 1.82 2.84 1.29 3.53.99.11-.77.42-1.29.76-1.58-2.67-.3-5.48-1.31-5.48-5.85 0-1.29.47-2.34 1.23-3.16-.12-.3-.53-1.52.12-3.17 0 0 1.01-.32 3.3 1.2a11.53 11.53 0 0 1 6 0c2.29-1.52 3.3-1.2 3.3-1.2.65 1.65.24 2.87.12 3.17.76.82 1.23 1.87 1.23 3.16 0 4.55-2.81 5.55-5.49 5.84.43.36.82 1.08.82 2.19v3.24c0 .32.22.7.83.58A12 12 0 0 0 12 .5Z"
					/>
				</svg>
				proxima812
			</a>
		</span>
	</Container>
</footer>
