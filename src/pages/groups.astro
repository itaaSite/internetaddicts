---
import GroupArticle from "@/components/GroupArticle.astro"
import Layout from "@/layout/Layout.astro"
import { getCollection } from "astro:content"

const groups = await getCollection("groups")
const groupsCounter = (await getCollection("groups")).length

const dayOrder = {
	–ü–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫: 1,
	–í—Ç–æ—Ä–Ω–∏–∫: 2,
	–°—Ä–µ–¥–∞: 3,
	–ß–µ—Ç–≤–µ—Ä–≥: 4,
	–ü—è—Ç–Ω–∏—Ü–∞: 5,
	–°—É–±–±–æ—Ç–∞: 6,
	–í–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ: 7,
	–ü–æ_–∑–∞–ø—Ä–æ—Å—É: 8,
}

const someDate = "2024-12-28"

function sortGroupsByDay(groups) {
	return groups
		.sort((a, b) => {
			const t1 = someDate + a.data.dateTime
			const t2 = someDate + b.data.dateTime
			return new Date(t2).getMilliseconds() - new Date(t1).getMilliseconds()
		})
		.sort((a, b) => {
			return dayOrder[a.data.when] - dayOrder[b.data.when]
		})
}
---

<Layout
	title={`–û–Ω–ª–∞–π–Ω –∏ –û—Ñ–ª–∞–π–Ω –≥—Ä—É–ø–ø—ã`}
	desc={`–í—Ä–µ–º—è –≤—Å—Ç—Ä–µ—á –¥–ª—è –∞–Ω–æ–Ω–∏–º–Ω—ã—Ö –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-–∑–∞–≤–∏—Å–∏–º—ã—Ö. –°–æ–±—Ä–∞–Ω–∏–π (${groupsCounter})`}
>
	<div
		class="flex-wrap bg-white flex gap-8 items-center md:gap-12 justify-between p-6 rounded-xl shadow-sm"
	>
		<div class="flex flex-col gap-2">
			<p>üòá –ù–∞–º —Å–ª–µ–¥—É–µ—Ç –ø—Ä–∏–Ω–∏–º–∞—Ç—å –≤—Å–µ—Ö, —Å—Ç—Ä–∞–¥–∞—é—â–∏—Ö –æ—Ç –ò–ó.</p>
			<p>üíØ –ü–æ—ç—Ç–æ–º—É –º—ã –Ω–µ –º–æ–∂–µ–º –æ—Ç–∫–∞–∑—ã–≤–∞—Ç—å –Ω–∏–∫–æ–º—É –∏–∑ —Ç–µ—Ö, –∫—Ç–æ –∂–µ–ª–∞–µ—Ç –≤—ã–∑–¥–æ—Ä–∞–≤–ª–∏–≤–∞—Ç—å.</p>
		</div>
		<a
			href="/posts/sozdaem-svoyu-gruppu-aiz-za-3-min"
			class="rounded-md px-3 py-2 bg-green-50 ring-1 ring-green-400 text-green-600"
			>–°–æ–∑–¥–∞—Ç—å –≥—Ä—É–ø–ø—É</a
		>
	</div>

	<h3 class="text-3xl text-gray-700 font-semibold">–û—Ñ—Ñ–ª–∞–π–Ω-–≥—Ä—É–ø–ø—ã</h3>

	<div class="grid grid-cols-1 items-start md:grid-cols-2 lg:grid-cols-4 gap-5">
		{
			groups &&
				sortGroupsByDay(groups.filter(f => f.data.type === "–ñ–∏–≤–∞—è")).map(group => (
					<GroupArticle data={group.data} body={group.body} />
				))
		}
	</div>

	<h3 class="text-3xl text-gray-700 font-semibold">–û–Ω–ª–∞–π–Ω-–≥—Ä—É–ø–ø—ã</h3>

	<div class="grid grid-cols-1 items-start md:grid-cols-2 lg:grid-cols-4 gap-5">
		{
			groups &&
				sortGroupsByDay(groups.filter(f => f.data.type === "–û–Ω–ª–∞–π–Ω")).map(group => (
					<GroupArticle data={group.data} body={group.body} />
				))
		}
	</div>
</Layout>
