---
import { marked } from "marked"

import Group from "@/components/Group.astro"
import { getCollection } from "astro:content"
import MainLayout from "../../layout/MainLayout.astro"

const groups = await getCollection("groups")
const groupsCounter = (await getCollection("groups")).length

const dayOrder = {
	–ü–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫: 1,
	–í—Ç–æ—Ä–Ω–∏–∫: 2,
	–°—Ä–µ–¥–∞: 3,
	–ß–µ—Ç–≤–µ—Ä–≥: 4,
	–ü—è—Ç–Ω–∏—Ü–∞: 5,
	–°—É–±–±–æ—Ç–∞: 6,
	–í–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ: 7,
}

function sortGroupsByDay(groups) {
	return groups.sort((a, b) => {
		return dayOrder[a.data.when] - dayOrder[b.data.when]
	})
}
---

<MainLayout
	title={`–û–Ω–ª–∞–π–Ω —Å–æ–±—Ä–∞–Ω–∏—è –∏ –û—Ñ–ª–∞–π–Ω`}
	description={`–í—Ä–µ–º—è –≤—Å—Ç—Ä–µ—á –¥–ª—è –∞–Ω–æ–Ω–∏–º–Ω—ã—Ö –∏–Ω—Ç–µ—Ä–Ω–µ—Ç –∑–∞–≤–∏—Å–∏–º—ã—Ö. –°–æ–±—Ä–∞–Ω–∏–π (${groupsCounter})`}
>
	<h3 class="text-2xl font-medium text-gray-700">
		‚≠ê –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –≥—Ä—É–ø–ø –Ω–∞ –¥–∞–Ω–Ω—ã–π –º–æ–º–µ–Ω—Ç: <b>{groupsCounter}</b>
	</h3>
	<h4 class="text-2xl text-gray-700 font-medium">
		üåê –û–Ω–ª–∞–π–Ω –≥—Ä—É–ø–ø—ã ({groups.filter(f => f.data.type === "–û–Ω–ª–∞–π–Ω").length})
	</h4>

	<div class="grid grid-cols-1 items-start md:grid-cols-2 lg:grid-cols-3 gap-5">
		{
			groups &&
				sortGroupsByDay(groups.filter(f => f.data.type === "–û–Ω–ª–∞–π–Ω")).map(group => (
					<Group data={group.data} slug={group.slug} />
				))
		}
	</div>
	<h4 class="text-2xl text-gray-700 font-medium">
		üå§ –ñ–∏–≤—ã–µ –≥—Ä—É–ø–ø—ã ({groups.filter(f => f.data.type === "–ñ–∏–≤–∞—è").length})
	</h4>
	<div class="grid grid-cols-1 items-start md:grid-cols-2 lg:grid-cols-3 gap-5">
		{
			groups &&
				sortGroupsByDay(groups.filter(f => f.data.type === "–ñ–∏–≤–∞—è")).map(group => (
					<Group data={group.data} slug={group.slug} />
				))
		}
	</div>
</MainLayout>
